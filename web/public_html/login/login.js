(()=>{var Xe=Object.create;var pe=Object.defineProperty;var Ze=Object.getOwnPropertyDescriptor;var Ve=Object.getOwnPropertyNames;var ke=Object.getPrototypeOf,et=Object.prototype.hasOwnProperty;var tt=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var nt=(e,t,n,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let s of Ve(t))!et.call(e,s)&&s!==n&&pe(e,s,{get:()=>t[s],enumerable:!(r=Ze(t,s))||r.enumerable});return e};var rt=(e,t,n)=>(n=e!=null?Xe(ke(e)):{},nt(t||!e||!e.__esModule?pe(n,"default",{value:e,enumerable:!0}):n,e));var Ye=tt((P,q)=>{var st=200,de="__lodash_hash_undefined__",Y=1,Ee=2,Le=9007199254740991,z="[object Arguments]",ne="[object Array]",ot="[object AsyncFunction]",xe="[object Boolean]",Ce="[object Date]",Re="[object Error]",Ie="[object Function]",at="[object GeneratorFunction]",$="[object Map]",Oe="[object Number]",it="[object Null]",O="[object Object]",he="[object Promise]",ct="[object Proxy]",qe="[object RegExp]",F="[object Set]",De="[object String]",dt="[object Symbol]",ut="[object Undefined]",re="[object WeakMap]",Pe="[object ArrayBuffer]",G="[object DataView]",lt="[object Float32Array]",ft="[object Float64Array]",pt="[object Int8Array]",ht="[object Int16Array]",gt="[object Int32Array]",mt="[object Uint8Array]",_t="[object Uint8ClampedArray]",vt="[object Uint16Array]",yt="[object Uint32Array]",bt=/[\\^$.*+?()[\]{}|]/g,Tt=/^\[object .+?Constructor\]$/,wt=/^(?:0|[1-9]\d*)$/,d={};d[lt]=d[ft]=d[pt]=d[ht]=d[gt]=d[mt]=d[_t]=d[vt]=d[yt]=!0;d[z]=d[ne]=d[Pe]=d[xe]=d[G]=d[Ce]=d[Re]=d[Ie]=d[$]=d[Oe]=d[O]=d[qe]=d[F]=d[De]=d[re]=!1;var Me=typeof global=="object"&&global&&global.Object===Object&&global,At=typeof self=="object"&&self&&self.Object===Object&&self,v=Me||At||Function("return this")(),Ue=typeof P=="object"&&P&&!P.nodeType&&P,ge=Ue&&typeof q=="object"&&q&&!q.nodeType&&q,Ne=ge&&ge.exports===Ue,k=Ne&&Me.process,me=function(){try{return k&&k.binding&&k.binding("util")}catch{}}(),_e=me&&me.isTypedArray;function St(e,t){for(var n=-1,r=e==null?0:e.length,s=0,o=[];++n<r;){var a=e[n];t(a,n,e)&&(o[s++]=a)}return o}function Et(e,t){for(var n=-1,r=t.length,s=e.length;++n<r;)e[s+n]=t[n];return e}function Lt(e,t){for(var n=-1,r=e==null?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}function xt(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}function Ct(e){return function(t){return e(t)}}function Rt(e,t){return e.has(t)}function It(e,t){return e?.[t]}function Ot(e){var t=-1,n=Array(e.size);return e.forEach(function(r,s){n[++t]=[s,r]}),n}function qt(e,t){return function(n){return e(t(n))}}function Dt(e){var t=-1,n=Array(e.size);return e.forEach(function(r){n[++t]=r}),n}var Pt=Array.prototype,Mt=Function.prototype,W=Object.prototype,ee=v["__core-js_shared__"],He=Mt.toString,m=W.hasOwnProperty,ve=function(){var e=/[^.]+$/.exec(ee&&ee.keys&&ee.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),je=W.toString,Ut=RegExp("^"+He.call(m).replace(bt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ye=Ne?v.Buffer:void 0,K=v.Symbol,be=v.Uint8Array,Be=W.propertyIsEnumerable,Nt=Pt.splice,E=K?K.toStringTag:void 0,Te=Object.getOwnPropertySymbols,Ht=ye?ye.isBuffer:void 0,jt=qt(Object.keys,Object),se=D(v,"DataView"),M=D(v,"Map"),oe=D(v,"Promise"),ae=D(v,"Set"),ie=D(v,"WeakMap"),U=D(Object,"create"),Bt=C(se),zt=C(M),$t=C(oe),Ft=C(ae),Gt=C(ie),we=K?K.prototype:void 0,te=we?we.valueOf:void 0;function L(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Kt(){this.__data__=U?U(null):{},this.size=0}function Qt(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}function Jt(e){var t=this.__data__;if(U){var n=t[e];return n===de?void 0:n}return m.call(t,e)?t[e]:void 0}function Yt(e){var t=this.__data__;return U?t[e]!==void 0:m.call(t,e)}function Wt(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=U&&t===void 0?de:t,this}L.prototype.clear=Kt;L.prototype.delete=Qt;L.prototype.get=Jt;L.prototype.has=Yt;L.prototype.set=Wt;function y(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Xt(){this.__data__=[],this.size=0}function Zt(e){var t=this.__data__,n=X(t,e);if(n<0)return!1;var r=t.length-1;return n==r?t.pop():Nt.call(t,n,1),--this.size,!0}function Vt(e){var t=this.__data__,n=X(t,e);return n<0?void 0:t[n][1]}function kt(e){return X(this.__data__,e)>-1}function en(e,t){var n=this.__data__,r=X(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this}y.prototype.clear=Xt;y.prototype.delete=Zt;y.prototype.get=Vt;y.prototype.has=kt;y.prototype.set=en;function x(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function tn(){this.size=0,this.__data__={hash:new L,map:new(M||y),string:new L}}function nn(e){var t=Z(this,e).delete(e);return this.size-=t?1:0,t}function rn(e){return Z(this,e).get(e)}function sn(e){return Z(this,e).has(e)}function on(e,t){var n=Z(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this}x.prototype.clear=tn;x.prototype.delete=nn;x.prototype.get=rn;x.prototype.has=sn;x.prototype.set=on;function Q(e){var t=-1,n=e==null?0:e.length;for(this.__data__=new x;++t<n;)this.add(e[t])}function an(e){return this.__data__.set(e,de),this}function cn(e){return this.__data__.has(e)}Q.prototype.add=Q.prototype.push=an;Q.prototype.has=cn;function w(e){var t=this.__data__=new y(e);this.size=t.size}function dn(){this.__data__=new y,this.size=0}function un(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n}function ln(e){return this.__data__.get(e)}function fn(e){return this.__data__.has(e)}function pn(e,t){var n=this.__data__;if(n instanceof y){var r=n.__data__;if(!M||r.length<st-1)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new x(r)}return n.set(e,t),this.size=n.size,this}w.prototype.clear=dn;w.prototype.delete=un;w.prototype.get=ln;w.prototype.has=fn;w.prototype.set=pn;function hn(e,t){var n=J(e),r=!n&&Rn(e),s=!n&&!r&&ce(e),o=!n&&!r&&!s&&Je(e),a=n||r||s||o,i=a?xt(e.length,String):[],u=i.length;for(var c in e)(t||m.call(e,c))&&!(a&&(c=="length"||s&&(c=="offset"||c=="parent")||o&&(c=="buffer"||c=="byteLength"||c=="byteOffset")||Sn(c,u)))&&i.push(c);return i}function X(e,t){for(var n=e.length;n--;)if(Fe(e[n][0],t))return n;return-1}function gn(e,t,n){var r=t(e);return J(e)?r:Et(r,n(e))}function H(e){return e==null?e===void 0?ut:it:E&&E in Object(e)?wn(e):Cn(e)}function Ae(e){return N(e)&&H(e)==z}function ze(e,t,n,r,s){return e===t?!0:e==null||t==null||!N(e)&&!N(t)?e!==e&&t!==t:mn(e,t,n,r,ze,s)}function mn(e,t,n,r,s,o){var a=J(e),i=J(t),u=a?ne:T(e),c=i?ne:T(t);u=u==z?O:u,c=c==z?O:c;var l=u==O,p=c==O,f=u==c;if(f&&ce(e)){if(!ce(t))return!1;a=!0,l=!1}if(f&&!l)return o||(o=new w),a||Je(e)?$e(e,t,n,r,s,o):bn(e,t,u,n,r,s,o);if(!(n&Y)){var h=l&&m.call(e,"__wrapped__"),g=p&&m.call(t,"__wrapped__");if(h||g){var b=h?e.value():e,_=g?t.value():t;return o||(o=new w),s(b,_,n,r,o)}}return f?(o||(o=new w),Tn(e,t,n,r,s,o)):!1}function _n(e){if(!Qe(e)||Ln(e))return!1;var t=Ge(e)?Ut:Tt;return t.test(C(e))}function vn(e){return N(e)&&Ke(e.length)&&!!d[H(e)]}function yn(e){if(!xn(e))return jt(e);var t=[];for(var n in Object(e))m.call(e,n)&&n!="constructor"&&t.push(n);return t}function $e(e,t,n,r,s,o){var a=n&Y,i=e.length,u=t.length;if(i!=u&&!(a&&u>i))return!1;var c=o.get(e);if(c&&o.get(t))return c==t;var l=-1,p=!0,f=n&Ee?new Q:void 0;for(o.set(e,t),o.set(t,e);++l<i;){var h=e[l],g=t[l];if(r)var b=a?r(g,h,l,t,e,o):r(h,g,l,e,t,o);if(b!==void 0){if(b)continue;p=!1;break}if(f){if(!Lt(t,function(_,S){if(!Rt(f,S)&&(h===_||s(h,_,n,r,o)))return f.push(S)})){p=!1;break}}else if(!(h===g||s(h,g,n,r,o))){p=!1;break}}return o.delete(e),o.delete(t),p}function bn(e,t,n,r,s,o,a){switch(n){case G:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case Pe:return!(e.byteLength!=t.byteLength||!o(new be(e),new be(t)));case xe:case Ce:case Oe:return Fe(+e,+t);case Re:return e.name==t.name&&e.message==t.message;case qe:case De:return e==t+"";case $:var i=Ot;case F:var u=r&Y;if(i||(i=Dt),e.size!=t.size&&!u)return!1;var c=a.get(e);if(c)return c==t;r|=Ee,a.set(e,t);var l=$e(i(e),i(t),r,s,o,a);return a.delete(e),l;case dt:if(te)return te.call(e)==te.call(t)}return!1}function Tn(e,t,n,r,s,o){var a=n&Y,i=Se(e),u=i.length,c=Se(t),l=c.length;if(u!=l&&!a)return!1;for(var p=u;p--;){var f=i[p];if(!(a?f in t:m.call(t,f)))return!1}var h=o.get(e);if(h&&o.get(t))return h==t;var g=!0;o.set(e,t),o.set(t,e);for(var b=a;++p<u;){f=i[p];var _=e[f],S=t[f];if(r)var fe=a?r(S,_,f,t,e,o):r(_,S,f,e,t,o);if(!(fe===void 0?_===S||s(_,S,n,r,o):fe)){g=!1;break}b||(b=f=="constructor")}if(g&&!b){var j=e.constructor,B=t.constructor;j!=B&&"constructor"in e&&"constructor"in t&&!(typeof j=="function"&&j instanceof j&&typeof B=="function"&&B instanceof B)&&(g=!1)}return o.delete(e),o.delete(t),g}function Se(e){return gn(e,qn,An)}function Z(e,t){var n=e.__data__;return En(t)?n[typeof t=="string"?"string":"hash"]:n.map}function D(e,t){var n=It(e,t);return _n(n)?n:void 0}function wn(e){var t=m.call(e,E),n=e[E];try{e[E]=void 0;var r=!0}catch{}var s=je.call(e);return r&&(t?e[E]=n:delete e[E]),s}var An=Te?function(e){return e==null?[]:(e=Object(e),St(Te(e),function(t){return Be.call(e,t)}))}:Dn,T=H;(se&&T(new se(new ArrayBuffer(1)))!=G||M&&T(new M)!=$||oe&&T(oe.resolve())!=he||ae&&T(new ae)!=F||ie&&T(new ie)!=re)&&(T=function(e){var t=H(e),n=t==O?e.constructor:void 0,r=n?C(n):"";if(r)switch(r){case Bt:return G;case zt:return $;case $t:return he;case Ft:return F;case Gt:return re}return t});function Sn(e,t){return t=t??Le,!!t&&(typeof e=="number"||wt.test(e))&&e>-1&&e%1==0&&e<t}function En(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}function Ln(e){return!!ve&&ve in e}function xn(e){var t=e&&e.constructor,n=typeof t=="function"&&t.prototype||W;return e===n}function Cn(e){return je.call(e)}function C(e){if(e!=null){try{return He.call(e)}catch{}try{return e+""}catch{}}return""}function Fe(e,t){return e===t||e!==e&&t!==t}var Rn=Ae(function(){return arguments}())?Ae:function(e){return N(e)&&m.call(e,"callee")&&!Be.call(e,"callee")},J=Array.isArray;function In(e){return e!=null&&Ke(e.length)&&!Ge(e)}var ce=Ht||Pn;function On(e,t){return ze(e,t)}function Ge(e){if(!Qe(e))return!1;var t=H(e);return t==Ie||t==at||t==ot||t==ct}function Ke(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=Le}function Qe(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}function N(e){return e!=null&&typeof e=="object"}var Je=_e?Ct(_e):vn;function qn(e){return In(e)?hn(e):yn(e)}function Dn(){return[]}function Pn(){return!1}q.exports=On});var Mn=rt(Ye(),1);function We(e){let t=document.createElement("dialog");t.classList.add("dialog-container","popup",e),t.open=!0,t.setAttribute("role","dialog");let n=document.createElement("div");n.classList.add("dialog-window"),t.append(n);let r=document.createElement("div");r.classList.add("dialog-logo"),n.append(r);let s=document.createElement("div");s.classList.add("dialog-heading"),n.append(s);let o=document.createElement("div");o.classList.add("dialog-message"),n.append(o);let a=document.createElement("div");a.classList.add("dialog-workarea"),n.append(a);let i=document.createElement("div");i.classList.add("dialog-buttons"),n.append(i);let u=document.createElement("span");u.classList.add("dialog-buttons-begin"),i.append(u);let c=document.createElement("button");c.classList.add("dialog-dismiss-button"),c.textContent="Cancel",i.append(c);let l=document.createElement("button");l.textContent="OK",i.append(l),n.addEventListener("keyup",({key:f})=>{f==="Enter"&&l.click()});let p=document.createElement("span");return p.classList.add("dialog-buttons-end"),i.append(p),{confirm:l,dismiss:c,heading:s,message:o,root:t,workarea:a}}var R=()=>{let n=window.location.pathname.split("/").filter(s=>s!==""&&!s.endsWith(".html")).reverse().indexOf("web"),r="../".repeat(n);return new URL(r,window.location.href).pathname.replace(/\/$/,"")};var V=class e extends EventTarget{constructor(t){super(),this.elements=e._create(t),this.elements.dismiss.addEventListener("click",()=>this._onDismiss()),this.options=t,document.body.append(this.elements.root),this.elements.dismiss.focus()}close(){if(!this.closed){this.elements.root.remove(),this.dispatchEvent(new Event("close"));for(let t of Object.keys(this))delete this[t];this.closed=!0}}_onDismiss(){this.close()}static _create(t){let{heading:n,message:r}=t,s=We("confirm-dialog");return s.confirm.remove(),delete s.confirm,s.heading.textContent=n,s.workarea.textContent=r,s}};var I={_DaemonVersion:"version",_DownSpeedLimit:"speed-limit-down",_DownSpeedLimited:"speed-limit-down-enabled",_QueueMoveBottom:"queue-move-bottom",_QueueMoveDown:"queue-move-down",_QueueMoveTop:"queue-move-top",_QueueMoveUp:"queue-move-up",_Root:new URL(`${R()}/../rpc`,window.location.href).pathname,_TurtleDownSpeedLimit:"alt-speed-down",_TurtleState:"alt-speed-enabled",_TurtleUpSpeedLimit:"alt-speed-up",_UpSpeedLimit:"speed-limit-up",_UpSpeedLimited:"speed-limit-up-enabled"},ue=class e{constructor(t){this._connection_alert=null,this._controller=t,this._session_id=""}sendRequest(t,n,r){let s=new Headers;s.append("cache-control","no-cache"),s.append("content-type","application/json"),s.append("pragma","no-cache"),A.addAuthHeaders(s),this._session_id&&s.append(e._SessionHeader,this._session_id);let o=null;fetch(I._Root,{body:JSON.stringify(t),headers:s,method:"POST"}).then(a=>{if(o=a,a.status===401&&A.redirectToLogin(),a.status===409){let i=new Error(e._SessionHeader);throw i.header=a.headers.get(e._SessionHeader),i}return a.json()}).then(a=>{n&&n.call(r,a,o),this._connection_alert&&(this._connection_alert.close(),this._connection_alert=null)}).catch(a=>{if(a.message===e._SessionHeader){this._session_id=a.header,this.sendRequest(t,n,r);return}console.trace(a),this._controller.togglePeriodicSessionRefresh(!1),this._connection_alert=new V({heading:"Connection failed",message:"Could not connect to the server. You may need to reload the page to reconnect."}),this._controller.setCurrentPopup(this._connection_alert)})}loadDaemonPrefs(t,n){let r={method:"session-get"};this.sendRequest(r,t,n)}checkPort(t,n,r){let s={arguments:{ip_protocol:t},method:"port-test"};this.sendRequest(s,n,r)}renameTorrent(t,n,r,s,o){let a={arguments:{ids:t,name:r,path:n},method:"torrent-rename-path"};this.sendRequest(a,s,o)}setLabels(t,n,r){let s={ids:t,labels:n};this.sendRequest({arguments:s,method:"torrent-set"},r)}loadDaemonStats(t,n){let r={method:"session-stats"};this.sendRequest(r,t,n)}updateTorrents(t,n,r,s){let o={arguments:{fields:n,format:"table"},method:"torrent-get"};t&&(o.arguments.ids=t),this.sendRequest(o,a=>{let i=a.arguments;r.call(s,i.torrents,i.removed)})}getFreeSpace(t,n,r){let s={arguments:{path:t},method:"free-space"};this.sendRequest(s,o=>{let a=o.arguments;n.call(r,a.path,a["size-bytes"])})}changeFileCommand(t,n,r){let s={ids:[t]};s[r]=n,this.sendRequest({arguments:s,method:"torrent-set"},()=>{this._controller.refreshTorrents([t])})}sendTorrentSetRequests(t,n,r,s,o){r||(r={}),r.ids=n;let a={arguments:r,method:t};this.sendRequest(a,s,o)}sendTorrentActionRequests(t,n,r,s){this.sendTorrentSetRequests(t,n,null,r,s)}startTorrents(t,n,r,s){let o=n?"torrent-start-now":"torrent-start";this.sendTorrentActionRequests(o,t,r,s)}stopTorrents(t,n,r){this.sendTorrentActionRequests("torrent-stop",t,n,r)}moveTorrents(t,n,r,s){this.sendTorrentSetRequests("torrent-set-location",t,{location:n,move:!0},r,s)}removeTorrents(t,n){let r={arguments:{"delete-local-data":n,ids:[]},method:"torrent-remove"};if(t)for(let s=0,o=t.length;s<o;++s)r.arguments.ids.push(t[s].getId());this.sendRequest(r,()=>{this._controller.refreshTorrents()})}verifyTorrents(t,n,r){this.sendTorrentActionRequests("torrent-verify",t,n,r)}reannounceTorrents(t,n,r){this.sendTorrentActionRequests("torrent-reannounce",t,n,r)}addTorrentByUrl(t,n){/^[\da-f]{40}$/i.test(t)&&(t=`magnet:?xt=urn:btih:${t}`);let r={arguments:{filename:t,paused:n.paused},method:"torrent-add"};this.sendRequest(r,()=>{this._controller.refreshTorrents()})}savePrefs(t){let n={arguments:t,method:"session-set"};this.sendRequest(n,()=>{this._controller.loadDaemonPrefs()})}updateBlocklist(){let t={method:"blocklist-update"};this.sendRequest(t,()=>{this._controller.loadDaemonPrefs()})}moveTorrentsToTop(t,n,r){this.sendTorrentActionRequests(I._QueueMoveTop,t,n,r)}moveTorrentsToBottom(t,n,r){this.sendTorrentActionRequests(I._QueueMoveBottom,t,n,r)}moveTorrentsUp(t,n,r){this.sendTorrentActionRequests(I._QueueMoveUp,t,n,r)}moveTorrentsDown(t,n,r){this.sendTorrentActionRequests(I._QueueMoveDown,t,n,r)}};ue._SessionHeader="X-Transmission-Session-Id";var le="credentials",A={addAuthHeaders(e,t=this.loadCredentials()){if(t){let n=btoa(`${t.username}:${t.password}`);e.append("Authorization",`Basic ${n}`)}e.append("TransmissionRPC-Suppress-Basic-Auth-Popup","true")},clearCredentials(){localStorage.removeItem(le)},loadCredentials(){let e=localStorage.getItem(le);if(e===null)return null;let t=JSON.parse(e);return t.createdAt=new Date(t.createdAt),t},redirectToLogin(){window.location.href=`${R()}/login/index.html`},storeCredentials(e,t){localStorage.setItem(le,JSON.stringify({createdAt:new Date().toISOString(),password:t,username:e}))},async testCredentials(e){let t=new Headers;this.addAuthHeaders(t,e);let n=await fetch(I._Root,{headers:t,method:"POST"});if(n.status===401)return!1;if(n.status!==204&&n.status!==409)throw new Error("Unexpected response from RPC auth check",n.status);return!0}};document.addEventListener("DOMContentLoaded",async()=>{await A.testCredentials(A.loadCredentials())&&(window.location.href=R()),document.querySelector("#login-form").addEventListener("submit",async n=>{n.preventDefault(),document.querySelector("#login-error").classList.remove("draw-attention");let r=document.querySelector("#username").value,s=document.querySelector("#password").value;if(!await A.testCredentials({password:s,username:r})){document.querySelector("#login-error").classList.remove("hidden"),document.querySelector("#login-error").classList.add("draw-attention");return}A.storeCredentials(r,s),window.location.href=R()})});})();
//# sourceMappingURL=login.js.map
